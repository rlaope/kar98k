# 개요

## kar98k란?

kar98k는 부하 테스트 및 성능 검증을 위해 현실적인 비정형 트래픽 패턴을 생성하도록 설계된 고성능 트래픽 시뮬레이션 도구입니다. HTTP/1.1, HTTP/2, gRPC 프로토콜을 지원합니다.

## 주요 기능

### 다중 프로토콜 지원
- **HTTP/1.1**: 연결 풀링을 지원하는 표준 HTTP
- **HTTP/2**: 성능 향상을 위한 스트림 멀티플렉싱
- **gRPC**: 네이티브 gRPC 헬스 체크 프로토콜 지원

### 비정형 트래픽 패턴
일정하거나 선형적으로 증가하는 트래픽을 생성하는 기존 부하 테스트 도구와 달리, kar98k는 다음을 사용하여 현실적인 트래픽 패턴을 생성합니다:

- **포아송 분포 스파이크**: 실제 사용 패턴을 모방하는 무작위 트래픽 버스트
- **마이크로 변동**: 트래픽 속도의 지속적인 미세 변화

### 시간대별 스케줄링
다양한 시간대에 다른 TPS(초당 트랜잭션) 프로파일을 설정할 수 있습니다:
- 업무 시간에는 높은 트래픽
- 야간에는 낮은 트래픽
- 모든 시간에 대한 사용자 정의 배율

### 레이트 리미팅
`golang.org/x/time/rate` 토큰 버킷 알고리즘을 사용한 정밀한 TPS 제어로 대상을 압도하지 않으면서 정확한 트래픽을 생성합니다.

### 헬스 모니터링
- 모든 대상에 대한 자동 헬스 체크
- 비정상 대상은 일시적으로 트래픽에서 제외
- 관측성을 위한 Prometheus 메트릭

### 우아한 종료
- 종료 시 깔끔한 요청 드레이닝
- 설정 가능한 종료 타임아웃
- 종료 중 요청 손실 없음

### 적응형 부하 탐색 (Adaptive Load Discovery)
시스템의 최대 지속 가능 TPS를 자동으로 탐색:
- 효율적인 탐색을 위한 이진 검색 알고리즘
- 설정 가능한 P95 지연 시간 및 에러율 임계값
- 권장 BaseTPS 및 MaxTPS 설정값 생성

## 사용 사례

1. **부하 테스트**: 현실적인 트래픽 패턴에서 시스템 성능 검증
2. **카오스 엔지니어링**: 트래픽 스파이크에 대한 시스템 복원력 테스트
3. **용량 계획**: 지속적인 트래픽으로 시스템 한계 파악
4. **성능 회귀**: 성능 모니터링을 위한 지속적인 트래픽 생성

## 아키텍처 개요

```
┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐
│  Pulse-Controller│────▶│  Pattern-Engine │────▶│   Pulse-Worker  │
│   (스케줄러)     │     │ (포아송/노이즈) │     │  (고루틴 풀)    │
└─────────────────┘     └─────────────────┘     └─────────────────┘
         │                                               │
         ▼                                               ▼
┌─────────────────┐                            ┌─────────────────┐
│  Health-Checker │                            │     타겟        │
│    (메트릭)     │                            │  (HTTP/gRPC)    │
└─────────────────┘                            └─────────────────┘
```

## 요구 사항

- Go 1.22 이상
- Docker (선택사항, 컨테이너화된 배포용)
